(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{"13b1":function(t,e,o){"use strict";var r=o("f185"),i=o.n(r);i.a},1554:function(t,e,o){"use strict";o.r(e);var r=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("q-page",{staticClass:"flex",class:{"flex-center":t.show.error||t.show.loading}},[t.show.error?r("div",{staticClass:"row full-width q-mt-lg"},[r("nd-spinner",{attrs:{name:"error",description:t.$t("error.web_error")}})],1):t.show.loading?r("div",{staticClass:"row full-width q-mt-lg"},[r("nd-spinner",{attrs:{name:"loading",description:t.$t("spinner.loading")}})],1):r("div",{staticClass:"full-width screen-padding screen-padding-xl"},[r("div",{staticClass:"q-pb-sm-sm"},[t.$store.state.order.gb_brief.group_buying_name?r("q-bar",{staticClass:"bg-accent text-white flex-center q-mt-sm-sm q-pa-md"},[r("p",{staticClass:"font-size-subtitle-1 q-ma-none text-bold"},[t._v("\n          "+t._s(t.$t("menu.tracking",{gb:t.$store.state.order.gb_brief.group_buying_name}))+"\n        ")])]):!t.noticeBar||t.show.out_of_business||t.show.rest?r("div",{staticClass:"q-pt-sm-sm"}):r("q-bar",{staticClass:"bg-secondary text-white flex-center q-mt-sm-sm q-pa-md"},[r("p",{staticClass:"font-size-subtitle-1 q-ma-none text-bold"},[t._v(t._s(t.noticeBar))])])],1),t.show.out_of_business||t.show.rest?t._e():r("div",[r("nd-home-v2-banner",{attrs:{"banner-list":t.brannerList,showShadow:!1,isMenu:!0}}),t.isLogin&&t.$q.screen.lt.sm?r("q-btn",{staticClass:"favorite-store-mobile",attrs:{dense:"",flat:"",round:""},on:{click:function(e){return e.stopPropagation(),t.updateFavoriteStore(e)}}},[r("q-icon",{staticClass:"q-ma-none",attrs:{size:"sm"}},[r("q-img",{attrs:{src:t.favoriteIcon.icon}})],1)],1):t._e(),r("div",{staticClass:"relative-position store-info-mobile q-mt-sm-xl q-mb-md q-mb-mb-lg flex justify-between q-px-md q-px-md-none",class:{column:t.$q.screen.lt.md}},[r("div",{staticClass:"flex no-wrap",class:t.$q.screen.lt.sm?"column full-width":""},[r("div",{class:t.$q.screen.lt.sm?"nd-mb-4":""},[r("div",{staticClass:"store-logo",staticStyle:{top:"0",left:"0"}},[r("img",{staticClass:"bg-white full-width",attrs:{src:t.store_info.image,alt:""}})])]),r("div",{class:["flex column",{"justify-center":!t.$q.screen.lt.sm}]},[r("div",{staticClass:"flex items-center nd-mb-2"},[!t.store_info.in_avail_nidin_league||t.isBrandDomain||t.isUBrand||t.isUStore?t._e():r("q-img",{staticClass:"nd-mr-1",attrs:{width:"16px",height:"16px",src:o("10f1")}}),r("span",{staticClass:"text-weight-medium  q-ml-xs",class:t.$q.screen.lt.md?"nd-font-size-subtitle":"nd-font-size-h6"},[t._v("\n                "+t._s(t.store_info.brand_name_short||t.store_info.brand_name)+"\n                "+t._s(t.store_info.name_short)+"\n              ")]),t.isLogin&&!t.$q.screen.lt.sm?r("q-btn",{attrs:{dense:"",flat:"",round:""},on:{click:function(e){return e.stopPropagation(),t.updateFavoriteStore(e)}}},[r("q-icon",{staticClass:"q-ma-none",attrs:{size:"sm"}},[r("q-img",{attrs:{src:t.favoriteIcon.icon}})],1)],1):t._e()],1),r("div",{staticClass:"flex"},[t.store_info.rating_average_star&&4!==t.store_info.store_mode?r("div",[r("div",{staticClass:"flex text-grey-7 nd-pr-2"},[t.store_info.rating_average_star?r("q-rating",{attrs:{size:"19px",max:1,color:"yellow-9",readonly:""},model:{value:t.store_info.rating_average_star,callback:function(e){t.$set(t.store_info,"rating_average_star",e)},expression:"store_info.rating_average_star"}}):t._e(),t.store_info.rating_average_star?r("span",{staticClass:"q-px-xs",domProps:{textContent:t._s(t.ratingStar(t.store_info.rating_average_star))}}):t._e(),t.store_info.rating_order_count?r("span",{domProps:{textContent:t._s("("+t.store_info.rating_order_count+")")}}):t._e()],1)]):t._e(),r("div",{},[r("i-li",{attrs:{icon:"time",name:t.openTime,iconColor:"bg-grey-7",color:"text-grey-7",listStyle:"padding: 0"}})],1)]),r("div",{staticClass:"flex nd-mt-1"},[r("div",{staticClass:"flex nd-pr-2"},[r("i-li",{attrs:{icon:"tag",name:t.distanceText,iconColor:"bg-grey-7",color:"text-grey-7",listStyle:"padding: 0"}}),3!==t.store_info.store_mode?r("a",{staticClass:"link",attrs:{href:t.linkMap(t.store_info),target:"_blank"},on:{click:function(e){return t.setGATag("view.store_info")}}},[r("span",{staticClass:"text-primary"},[t._v(t._s(t.showAddress))])]):t._e()],1),t.store_info.tel&&!t.$q.screen.lt.md?r("a",{attrs:{href:"tel:"+t.store_info.tel},on:{click:function(e){return t.setGATag("view.store_info")}}},[r("i-li",{attrs:{icon:"phone",name:t.store_info.tel,color:"text-primary",iconColor:"bg-grey-7",listStyle:"padding: 0"}})],1):t._e()])])]),r("div",{staticClass:"nd-pt-2 scroll-x",class:{"nd-mt-2":t.$q.screen.lt.md}},[r("div",{staticClass:"row no-wrap"},[r("div",{staticClass:"col-auto flex items-center nd-pr-4 cursor-pointer min-w-70px",class:{column:!t.$q.screen.lt.md},on:{click:t.clickService}},[r("div",{staticClass:"bg-gray-6 nd-p-2 nd-rounded-md"},[r("nd-icon",{staticStyle:{margin:"0px"},attrs:{color:"bg-gray-2",name:"question-circle-fill",size:"14px"}})],1),r("div",{staticClass:"text-gray-2",class:t.$q.screen.lt.md?"nd-ml-1":"nd-mt-1"},[t._v("\n                "+t._s(t.$t("menu.order_info"))+"\n              ")])]),t.store_info.has_membership?r("div",{staticClass:"col-auto flex items-center nd-pr-4 cursor-pointer min-w-70px",class:{column:!t.$q.screen.lt.md},on:{click:t.clickMemberCard}},[r("div",{staticClass:"bg-gray-6 nd-p-2 nd-rounded-md"},[r("nd-icon",{staticStyle:{margin:"0px"},attrs:{color:"bg-gray-2",name:"medal-fill",size:"14px"}})],1),r("div",{staticClass:"text-gray-2",class:t.$q.screen.lt.md?"nd-ml-1":"nd-mt-1"},[t._v("\n                "+t._s(t.$t("main_fun.member_intro"))+"\n              ")])]):t._e(),3===t.store_info.store_mode||t.$q.screen.lt.md?t._e():r("div",{staticClass:"col-auto flex items-center nd-pr-4 cursor-pointer min-w-70px",class:{column:!t.$q.screen.lt.md},on:{click:t.checkGB}},[r("div",{staticClass:"bg-gray-6 nd-p-2 nd-rounded-md"},[r("nd-icon",{staticStyle:{margin:"0px"},attrs:{color:"bg-gray-2",name:"group-fill",size:"14px"}})],1),r("div",{staticClass:"text-gray-2",class:t.$q.screen.lt.md?"nd-ml-1":"nd-mt-1"},[t._v("\n                "+t._s(t.$t("menu.group"))+"\n              ")])]),t.store_info.is_show_brand_point_mall||t.store_info.is_show_point_mall?r("div",{staticClass:"col-auto flex items-center nd-pr-4 cursor-pointer min-w-70px",class:{column:!t.$q.screen.lt.md},on:{click:t.clickPointMall}},[r("div",{staticClass:"bg-gray-6 nd-p-2 nd-rounded-md"},[r("nd-icon",{staticStyle:{margin:"0px"},attrs:{color:"bg-gray-2",name:"point-fill",size:"14px"}})],1),r("div",{staticClass:"text-gray-2",class:t.$q.screen.lt.md?"nd-ml-1":"nd-mt-1"},[t._v("\n                "+t._s(t.$t("menu.point_mall"))+"\n              ")])]):t._e(),r("div",{staticClass:"col-auto flex items-center nd-pr-4 cursor-pointer min-w-70px",class:{column:!t.$q.screen.lt.md},on:{click:function(e){return t.$router.push({name:"brandcode",params:{brand_code:t.store_info.brand_code}})}}},[r("div",{staticClass:"bg-gray-6 nd-p-2 nd-rounded-md"},[r("nd-icon",{staticStyle:{margin:"0px"},attrs:{color:"bg-gray-2",name:"store-fill",size:"14px"}})],1),r("div",{staticClass:"text-gray-2",class:t.$q.screen.lt.md?"nd-ml-1":"nd-mt-1"},[t._v("\n                "+t._s(t.$t("main_fun.brand_area"))+"\n              ")])])])]),t.$q.screen.lt.md?r("div",{staticClass:"absolute group-btn-mobile"},[r("div",{staticClass:"btn border border-primary nd-font-size-caption nd-font-weight-medium text-primary flex items-center cursor-pointer",on:{click:t.checkGB}},[r("nd-icon",{attrs:{name:"user-add",color:"bg-primary",size:"14px"}}),t._v("\n            "+t._s(t.$t("menu.group"))+"\n          ")],1)]):t._e()])],1),t.$q.screen.lt.sm?r("div",{staticClass:"fake-gap bg-grey-2"}):t._e(),t.show.store_prepare?r("div",{staticClass:"row full-width"},[r("div",{staticClass:"row full-width q-mt-lg"},[r("div",{staticClass:"full-width q-py-lg"},[r("div",[r("div",{staticClass:"text-center"},[r("div",{staticClass:"inline-block full-width q-pa-lg",staticStyle:{"max-width":"450px"}},[r("img",{staticClass:"full-whdth",attrs:{src:o("1b50"),alt:"store_prepare"}}),r("div",{staticClass:"absolute bg-white circle",staticStyle:{width:"11.2%",top:"42%",right:"28.2%"}},[r("img",{staticClass:"full-width circle",attrs:{src:t.store_info.image,alt:"store_prepare"}})])])]),r("div",{staticClass:"text-center"},[r("div",{staticClass:"text-bold text-center font-size-subtitle-1"},[t._v("門市籌備中，敬請期待")])])])])])]):t.show.out_of_business?r("div",{staticClass:"row full-width"},[r("nd-spinner",{attrs:{name:"out_of_business"}})],1):t.show.rest?r("div",{staticClass:"row full-width"},[r("nd-spinner",{attrs:{name:"rest"}})],1):r("div",[t.voucherOpen&&!t.voucherOrder.no_menu?r("q-tabs",{staticClass:"category-select-block nd-mb-4 q-mt-xs text-grey-9 q-mt-sm-lg",class:{"border-bottom":!t.$q.screen.lt.md},attrs:{align:t.$q.screen.lt.md?"center":"left","narrow-indicator":"",dense:"",breakpoint:0,"active-class":"b-color nd-fony-weight-medium"},model:{value:t.menuType,callback:function(e){t.menuType=e},expression:"menuType"}},t._l(t.tabList,(function(e){return r("q-tab",{key:e.name,attrs:{name:e.name}},[r("div",{class:{"nd-font-size-title nd-py-3":!t.$q.screen.lt.md}},[t._v("\n            "+t._s(e.label)+"\n          ")])])})),1):t._e(),t.show.activity&&"voucher"!==t.menuType?r("div",{staticClass:"full-width nd-my-4 q-pt-md-sm q-px-md q-px-md-none"},[r("activity",{attrs:{activityList:t.activity_list,storeInfo:t.store_info,mappingList:t.mapping_list,showCollapse:!0,isGroup:!!t.share_code}})],1):t._e(),r("div",{ref:"menu",staticClass:"row full-width menu-block q-mt-sm-sm"},[r("KeepAlive",["product"===t.menuType&&t.productOrder.no_menu?r("div",{staticClass:"row full-width"},[r("nd-spinner",{attrs:{name:"error",description:"門市目前無上架菜單，請聯絡客服"}})],1):"voucher"===t.menuType&&t.voucherOrder.no_menu?r("div",{staticClass:"row full-width"},[r("nd-spinner",{attrs:{name:"error",description:"門市目前無上架菜單，請聯絡客服"}})],1):"voucher"===t.menuType?r("menu-list-voucher",{attrs:{menu:t.voucherMenu,storeInfo:t.store_info,imgList:t.img_list,disableList:t.disable_list,top:t.menu_top,orderInfo:t.voucherOrder.order_info,orderId:t.voucherOrder.order_id,prodSettingList:t.prod_setting_list},on:{clickSearch:function(e){return t.clickSearch("voucher")}}}):r("menu-list-v2",{attrs:{menu:t.menu_json,storeInfo:t.store_info,layout:t.layout,iconList:t.icon_list,imgList:t.img_list,disableList:t.disable_list,top:t.menu_top,orderInfo:t.productOrder.order_info,orderId:t.productOrder.order_id,menuInfo:t.menu_info,recommendedList:t.recommended_list,prodSettingList:t.prod_setting_list,voucherPackList:t.voucher_pack_list,promotionList:t.promotion_list,orderOthers:t.productOrder.order_others},on:{clickSearch:function(e){return t.clickSearch("product")}}})],1),r("q-scroll-observer",{attrs:{debounce:1},on:{scroll:t.scrollMenuTop}})],1)],1)]),r("q-dialog",{staticClass:"flex flex-center column",model:{value:t.show.banner,callback:function(e){t.$set(t.show,"banner",e)},expression:"show.banner"}},[t.brannerList[t.slide]?r("div",{staticClass:"full-width q-ma-lg q-py-lg no-shadow dialog-width"},[r("img",{staticClass:"full-width",attrs:{src:t.brannerList[t.slide].image,alt:""}})]):t._e()]),t.showCart?r("q-page-sticky",{attrs:{position:t.$q.screen.lt.md?"bottom":"bottom-right",offset:t.$q.screen.lt.md?[0,0]:[80,80]}},[r("div",{staticClass:"bg-white nd-py-3 nd-px-4",class:t.$q.screen.lt.md?"row w-100vw border-top":"cart-shadow border-around"},[r("div",{staticClass:"flex items-center q-mb-md-sm col",class:t.$q.screen.lt.md?"":"justify-center"},[r("div",{staticClass:"nd-mr-3"},[r("div",{staticClass:"flex font-size-caption product-amount bg-red text-white"},[t._v("\n            "+t._s(t.cartAmount)+"\n          ")]),r("nd-icon",{attrs:{color:"black",name:"voucher"===t.menuType?"tickets":"shopping-bag",size:"1.6rem"}})],1),r("div",{staticClass:"text-weight-medium font-size-subtitle-1"},[t._v("\n          $ "+t._s(t.roundingNum(t.order_info.rounding_type,t.cartMoney)||0)+"\n        ")])]),r("div",{staticClass:"col b-bg nd-px-4 nd-py-2 text-white cursor-pointer border-m-around flex align-center justify-center",on:{click:t.goCart}},[r("div",{staticClass:"q-mr-sm text-weight-bold"},[t._v("\n          "+t._s("voucher"===t.menuType?t.$t("order.voucher"):t.$t("order.product"))+"結帳\n        ")]),r("div",[r("q-icon",{staticClass:"q-ma-none",staticStyle:{top:"-1px"},attrs:{size:"14px",name:"arrow_forward_ios"}})],1)])])]):t._e(),r("q-dialog",{staticClass:"flex flex-center column",attrs:{maximized:t.$q.screen.lt.sm},model:{value:t.show.modal_service,callback:function(e){t.$set(t.show,"modal_service",e)},expression:"show.modal_service"}},[r("div",{ref:"orderInfoCategory",class:["nidin-modal fix-modal-lg absolute z-top",{"box-shadow":!t.scroll.isTop,top:t.$q.screen.lt.sm}]},[r("img",{staticClass:"nidin-close sticky-header",attrs:{src:o("49c2"),alt:"close_icon"},on:{click:t.closeOrderInfoDialog}}),r("div",{staticClass:"full-width font-size-subtitle-2 q-py-md"},[t._v("訂購資訊")]),r("div",{staticClass:"search-input"},[r("div",{staticClass:"point-content-tab q-mb-xs"},[r("q-tabs",{staticClass:"b-white font-size-subtitle-2 category-select-block text-gray-4",attrs:{"inline-label":"",align:"justify","active-class":"text-brand-color"},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[r("q-tab",{attrs:{name:"storeInfo",label:t.$t("menu.store_info")}}),r("q-tab",{attrs:{name:"rule",label:t.$t("menu.rule")}}),r("q-tab",{attrs:{name:"faq",label:t.$t("account.faq")}})],1)],1),"faq"===t.tab?r("div",{staticClass:"q-mt-md"},[t.scroll.isTop||t.searchFaq?r("i-input",{ref:"search",staticClass:"q-py-sm",attrs:{opt:t.searchFaqOpt},model:{value:t.searchFaq,callback:function(e){t.searchFaq=e},expression:"searchFaq"}}):t._e(),!t.searchFaq&&t.faqList.length?r("nd-faq-category",{class:{"q-mt-md":!t.scroll.isTop},attrs:{list:t.faqList,isOpen:t.scroll.isTop,active:t.currentCategory,closeCategory:t.closeCategory},on:{showMask:t.showMask,update:t.changeCategory,extend:t.changePanelHeight}}):t._e()],1):t._e()])]),r("q-card",{ref:"orderInfo",staticClass:"order-modal full-width self-start",style:"padding-top: "+t.categoryHeight+"px;"},["rule"===t.tab?r("div",{staticClass:"q-px-md"},[r("delivery-service",{attrs:{storeInfo:t.store_info,hideTitle:!0}})],1):"storeInfo"===t.tab?r("div",{staticClass:"q-px-md"},[r("store-detail",{attrs:{storeInfo:t.store_info,showStoreName:!0,hideTitle:!0}})],1):r("div",[r("nd-faq-list",{ref:"category",attrs:{search:t.searchFaq,list:t.currentList,showLastBorder:!0}})],1),r("q-scroll-observer",{attrs:{"scroll-target":t.$refs.orderInfo,debounce:"20"},on:{scroll:t.scrollEvent}})],1),t.isShowMask?r("div",{staticClass:"inside-mask",on:{click:function(e){t.closeCategory=!0}}}):t._e()],1),r("q-dialog",{staticClass:"flex flex-center column",model:{value:t.show.modal_gb,callback:function(e){t.$set(t.show,"modal_gb",e)},expression:"show.modal_gb"}},[r("q-card",{staticClass:"nidin-modal"},[r("img",{staticClass:"nidin-close",attrs:{src:o("49c2"),alt:"close_icon"},on:{click:function(e){t.show.modal_gb=!1}}}),r("copy-gb",{attrs:{shareCode:t.share_code,store:t.store_info,hasVoucherMenu:t.voucherOpen}})],1)],1),r("q-dialog",{staticClass:"flex flex-center column",attrs:{maximized:t.$q.screen.lt.sm},model:{value:t.show.modal_search_prod,callback:function(e){t.$set(t.show,"modal_search_prod",e)},expression:"show.modal_search_prod"}},[r("div",{class:["nidin-modal fix-modal-lg absolute z-top",{"box-shadow":!t.scroll.isTop,top:t.$q.screen.lt.sm}]},[r("img",{staticClass:"nidin-close sticky-header",attrs:{src:o("49c2"),alt:"close_icon"},on:{click:function(e){t.show.modal_search_prod=!1}}}),r("div",{staticClass:"text-bold full-width font-size-subtitle-1"},[t._v(t._s(t.$t("menu.search_title")))]),r("div",{directives:[{name:"show",rawName:"v-show",value:"up"===t.scroll.direction||t.scroll.isTop,expression:"scroll.direction === 'up' || scroll.isTop"}],staticClass:"search-input"},[r("i-input",{attrs:{opt:t.search_prod_opt},model:{value:t.search_prod,callback:function(e){t.search_prod=e},expression:"search_prod"}})],1)]),r("q-card",{staticClass:"bg-white nidin-modal fix-modal-lg search-modal"},[r("q-card-section",{ref:"searchProduct",staticClass:"scroll q-mb-sm q-pa-none content-pt",style:t.$q.screen.lt.sm?"max-height: calc(100vh - 12px)":"max-height: 93vh"},[r("search-list",{attrs:{menu:t.menu_json,storeInfo:t.store_info,layout:t.layout,iconList:t.icon_list,imgList:t.img_list,disableList:t.disable_list,top:t.menu_top,searchProd:t.search_prod,orderInfo:t.productOrder.order_info,orderId:t.productOrder.order_id,menuInfo:t.menu_info,prodSettingList:t.prod_setting_list,voucherPackList:t.voucher_pack_list,promotionList:t.promotion_list}}),r("q-scroll-observer",{attrs:{"scroll-target":t.$refs.searchProduct,debounce:"20"},on:{scroll:t.scrollEvent}})],1)],1)],1),t.$q.screen.lt.md&&t.fixHeaderMenuTab&&t.voucherOpen&&!t.voucherOrder.no_menu?r("div",{staticClass:"mobile-menu-type-tab"},[r("div",{staticClass:"flex cursor-pointer header-menu-tab"},t._l(t.tabList,(function(e){return r("div",{key:e.name,staticClass:"nd-px-2 bg-grey-3",class:{"b-bg":t.menuType===e.name},on:{click:function(o){t.menuType=e.name}}},[r("nd-icon",{class:{"bg-white":t.menuType===e.name},attrs:{name:"voucher"===e.name?"tickets":"shopping-bag",size:"1rem"}})],1)})),0)]):t._e(),r("script",{attrs:{type:"application/ld+json"}},[t._v("\n    "+t._s(t.structuredData)+"\n  ")])],1)},i=[],s=(o("8e6e"),o("8a81"),o("c5f6"),o("20d6"),o("551c"),o("097d"),o("6b54"),o("6762"),o("2fdb"),o("28a5"),o("967e")),n=o.n(s),a=(o("96cf"),o("fa84")),c=o.n(a),d=(o("5df3"),o("4f7f"),o("4db1")),u=o.n(d),l=(o("a481"),o("c47a")),h=o.n(l),m=(o("ac6a"),o("cadf"),o("06db"),o("456d"),o("7f7f"),o("7514"),o("c684")),f=o("7b43"),p=o("4eb9"),g=o("c1df"),v=o.n(g),b=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"full-width"},[t.$q.screen.lt.md?o("div",{class:{"fixed-bar":t.showCategoryBar}},[o("div",{staticClass:"row text-white b-bg"},[o("div",{staticClass:"col overflow-hidden"},[o("q-tabs",{staticClass:"text-white b-bg category-select-block",attrs:{"inline-label":"",dense:""},model:{value:t.select.category,callback:function(e){t.$set(t.select,"category",e)},expression:"select.category"}},[t.storeInfo.menu_ab_block_type&&t.promotionAmount.total&&3!==t.storeInfo.store_mode&&!t.block_menu_show?t._l(t.promotionListSort,(function(e,r){return o("q-tab",{key:"category-bar-"+r,attrs:{label:"red"===r?t.$t("menu.red"):t.$t("menu.green"),name:r}},[t.promotionCartAmount[r]?o("div",{staticClass:"q-ml-xs flex font-size-caption product-amount bg-white"},[o("span",{staticClass:"b-color"},[t._v("\n                "+t._s(t.promotionCartAmount[r])+"\n              ")])]):t._e()])})):t._e(),t.recommendedAmount.total&&3!==t.storeInfo.store_mode&&!t.block_menu_show?t._l(t.recommendedListSort,(function(e,r){return o("q-tab",{key:"category-bar-"+r,attrs:{label:"history"===r?t.$t("menu.history"):t.$t("menu.products_featured"),name:r}},[t.recommendedCartAmount[r]?o("div",{staticClass:"q-ml-xs flex font-size-caption product-amount bg-white"},[o("span",{staticClass:"b-color"},[t._v("\n                "+t._s(t.recommendedCartAmount[r])+"\n              ")])]):t._e()])})):t._e(),t._l(t.categoryListSort,(function(e,r){return t.block_menu_show?t._e():o("q-tab",{key:"category-bar-"+r,attrs:{label:t.getCategoryName(e[t.schema.category.name],e),name:e[t.schema.category.product_id]}},[t.categoryCartAmount[e[t.schema.category.product_id]]?o("div",{staticClass:"q-ml-xs flex font-size-caption product-amount bg-white"},[o("span",{staticClass:"b-color"},[t._v("\n                "+t._s(t.categoryCartAmount[e[t.schema.category.product_id]])+"\n              ")])]):t._e()])})),t.block_menu_show?o("q-tab",{staticClass:"q-pl-xl",attrs:{focus:"",label:"全部分類"}}):t._e()],2)],1),o("div",{staticClass:"b-bg"},[o("q-btn",{staticClass:"q-px-sm btn-menu-more",attrs:{dense:"",size:"13px","text-color":"white",icon:t.block_menu_show?"fas fa-angle-up":"fas fa-angle-down"},on:{click:function(e){t.block_menu_show=!t.block_menu_show}}})],1),t.isVendorStore?t._e():o("q-btn",{staticClass:"q-px-sm straight-line",attrs:{size:"9px",dense:"",flat:"",color:"white",icon:"fas fa-search"},on:{click:function(e){return t.$emit("clickSearch")}}})],1),t.block_menu_show?o("div",{staticClass:"bg-white block-meun"},[o("div",{staticClass:"row"},[t.storeInfo.menu_ab_block_type&&t.promotionAmount.total&&3!==t.storeInfo.store_mode?t._l(t.promotionListSort,(function(e,r){return o("div",{key:"block-bar--"+r,staticClass:"col-6 block-meun-bg"},[o("div",{class:["block-meun-list",{"b-bg text-white":t.select.category===r}],on:{click:function(e){return t.selectBlockMenu(r)}}},[t._v("\n              "+t._s("red"===r?t.$t("menu.red"):t.$t("menu.green"))+"\n              "),t.promotionCartAmount[r]?o("div",{staticClass:"q-ml-xs flex font-size-caption product-amount",class:t.select.category===r?"bg-white b-color":"b-bg text-white"},[o("span",[t._v("\n                  "+t._s(t.promotionCartAmount[r])+"\n                ")])]):t._e()])])})):t._e(),t.recommendedAmount.total&&3!==t.storeInfo.store_mode?t._l(t.recommendedListSort,(function(e,r){return o("div",{key:"block-bar--"+r,staticClass:"col-6 block-meun-bg"},[o("div",{class:["block-meun-list",{"b-bg text-white":t.select.category===r}],on:{click:function(e){return t.selectBlockMenu(r)}}},[t._v("\n              "+t._s("history"===r?t.$t("menu.history"):t.$t("menu.products_featured"))+"\n              "),t.recommendedCartAmount[r]?o("div",{staticClass:"q-ml-xs flex font-size-caption product-amount",class:t.select.category===r?"bg-white b-color":"b-bg text-white"},[o("span",[t._v("\n                  "+t._s(t.recommendedCartAmount[r])+"\n                ")])]):t._e()])])})):t._e(),t._l(t.categoryListSort,(function(e,r){return o("div",{key:"block-bar-"+r,staticClass:"col-6 block-meun-bg"},[o("div",{class:["block-meun-list",t.select.category===e[t.schema.category.product_id]?"b-bg text-white":""],on:{click:function(o){return t.selectBlockMenu(e[t.schema.category.product_id])}}},[t._v("\n            "+t._s(t.getCategoryName(e[t.schema.category.name],e))+"\n            "),t.categoryCartAmount[e[t.schema.category.product_id]]?o("div",{staticClass:"q-ml-xs flex font-size-caption product-amount",class:t.select.category===e[t.schema.category.product_id]?"bg-white b-color":"b-bg text-white"},[o("span",[t._v("\n                "+t._s(t.categoryCartAmount[e[t.schema.category.product_id]])+"\n              ")])]):t._e()])])}))],2)]):t._e()]):t._e(),o("div",{staticClass:"q-pb-md"},[o("div",{ref:"grid",class:["menu-list grid full-width overflow-hidden",{"mt-36":t.showCategoryBar&&t.$q.screen.lt.md}]},[t.storeInfo.menu_ab_block_type?t._l(t.promotionListSort,(function(e,r){return o("div",{key:"category-"+r,ref:"category-"+r,refInFor:!0,staticClass:"item menu-item"},[o("q-card",{staticClass:"category-card",class:{"border border-color-light":!t.$q.screen.lt.sm}},[o("div",{staticClass:"q-py-sm"},[o("div",{staticClass:"flex flex-center justify-between q-px-md"},[o("div",{staticClass:"q-py-sm b-color nd-font-weight-medium col",class:t.$q.screen.lt.md?"nd-font-size-body":"nd-font-size-title"},[t._v("\n                  "+t._s("red"===r?t.$t("menu.red"):t.$t("menu.green"))+"\n                ")]),t.storeInfo.show_menu_icon&&2!==t.storeInfo.show_menu_icon?o("div",{staticClass:"col-auto flex"},[3!==t.storeInfo.store_mode?o("div",{staticClass:"col text-primary text-center text-cold-hot"},[t._v("\n                    "+t._s(t.$t("menu.ice"))+"\n                  ")]):t._e(),3!==t.storeInfo.store_mode?o("div",{staticClass:"col text-secondary text-center text-cold-hot"},[t._v("\n                    "+t._s(t.$t("menu.hot"))+"\n                  ")]):t._e()]):t._e()]),o("ul",[t._l(Object.keys(e).map(Number),(function(i,s){return[t.productList[i]&&t.productList[i][t.schema.product.is_visible]&&t.productList[i][t.schema.product.is_enable]?o("menu-prod-block",{key:"menu-prod-block-ref-"+i,class:{"border-b-list":s<Object.keys(e).length-1},attrs:{menu:t.menu,prodId:i,storeInfo:t.storeInfo,layout:t.layout,iconList:t.iconList,imgList:t.imgList,categoryId:t.getProdCategory(i),disableList:t.disableList,orderInfo:t.orderInfo,orderId:t.orderId,orderOthers:t.orderOthers,menuInfo:t.menuInfo,showModal:t.show,prodSettingList:t.prodSettingList,promotionListSort:t.promotionListSort,promotionList:t.promotionList,promotionBlock:r,amount:t.promoteProductCartAmount(i,r)}}):t._e()]}))],2)])])],1)})):t._e(),t._l(t.recommendedListSortHandler,(function(e,r){return o("div",{key:"category-"+r,ref:"category-"+r,refInFor:!0,staticClass:"item menu-item"},[o("q-card",{staticClass:"category-card no-shadow",class:{"border border-color-light":!t.$q.screen.lt.sm}},[o("div",{staticClass:"q-py-sm"},[o("div",{staticClass:"flex flex-center justify-between q-px-md"},[o("div",{staticClass:"q-py-sm b-color nd-font-weight-medium col",class:t.$q.screen.lt.md?"nd-font-size-body":"nd-font-size-title"},[t._v("\n                "+t._s("history"===r?t.$t("menu.history"):t.$t("menu.products_featured"))+"\n              ")]),t.storeInfo.show_menu_icon&&2!==t.storeInfo.show_menu_icon?o("div",{staticClass:"col-auto flex"},[3!==t.storeInfo.store_mode?o("div",{staticClass:"col text-primary text-center text-cold-hot"},[t._v("\n                  "+t._s(t.$t("menu.ice"))+"\n                ")]):t._e(),3!==t.storeInfo.store_mode?o("div",{staticClass:"col text-secondary text-center text-cold-hot"},[t._v("\n                  "+t._s(t.$t("menu.hot"))+"\n                ")]):t._e()]):t._e()]),o("ul",[t._l(e,(function(r,i){return[t.productList[r]&&t.productList[r][t.schema.product.is_visible]&&t.productList[r][t.schema.product.is_enable]?o("menu-prod-block",{key:"menu-prod-block-ref-"+r,class:{"border-b-list":i<e.length-1},attrs:{menu:t.menu,prodId:r,storeInfo:t.storeInfo,layout:t.layout,iconList:t.iconList,imgList:t.imgList,categoryId:t.getProdCategory(r),disableList:t.disableList,orderInfo:t.orderInfo,orderId:t.orderId,orderOthers:t.orderOthers,menuInfo:t.menuInfo,showModal:t.show,prodSettingList:t.prodSettingList,promotionListSort:t.promotionListSort,promotionList:t.promotionList,amount:t.cartAmount(r)}}):t._e()]}))],2)])])],1)})),t._l(t.categoryListSort,(function(e,r){return o("div",{key:"category-"+r,ref:"category-"+e[t.schema.category.product_id],refInFor:!0,staticClass:"item menu-item"},[o("q-card",{staticClass:"category-card no-shadow",class:{"border border-color-light":!t.$q.screen.lt.sm}},[t.hasImg?t._e():o("div",[t.imgList[e[t.schema.category.product_id]]?o("div",{class:["full-height gt-sm full-width overflow-hidden no-border-radius",t.img_loading?"q-pa-none":"q-py-md"]},[o("q-img",{attrs:{src:t.imgList[e[t.schema.category.product_id]].main_image.url},on:{load:function(e){t.img_loading=!0}}})],1):t._e()]),o("div",{staticClass:"q-py-sm"},[o("div",{staticClass:"flex flex-center justify-between q-px-md"},[o("div",{staticClass:"q-py-sm b-color nd-font-weight-medium col",class:t.$q.screen.lt.md?"nd-font-size-body":"nd-font-size-title"},[t._v("\n                "+t._s(t.getCategoryName(e[t.schema.category.name],e))+"\n              ")]),t.storeInfo.show_menu_icon&&2!==t.storeInfo.show_menu_icon?o("div",{staticClass:"col-auto flex"},[3!==t.storeInfo.store_mode?o("div",{staticClass:"col text-primary text-center text-cold-hot"},[t._v("\n                  "+t._s(t.$t("menu.ice"))+"\n                ")]):t._e(),3!==t.storeInfo.store_mode?o("div",{staticClass:"col text-secondary text-center text-cold-hot"},[t._v("\n                  "+t._s(t.$t("menu.hot"))+"\n                ")]):t._e()]):t._e()]),o("div",[t.recycleScrollerOn?o("div",[o("recycle-scroller",{staticClass:"scroller",attrs:{buffer:100,items:t.productListSort(e),"item-size":t.itemSize,"key-field":"id"},scopedSlots:t._u([{key:"default",fn:function(r){var i=r.item,s=r.index;return[o("menu-prod-block",{key:"menu-prod-block-"+i,class:{"border-b-list":s<t.productListSort(e).length-1},attrs:{menu:t.menu,prodId:i,storeInfo:t.storeInfo,layout:t.layout,iconList:t.iconList,imgList:t.imgList,categoryId:e[t.schema.category.product_id],disableList:t.disableList,orderInfo:t.orderInfo,orderId:t.orderId,orderOthers:t.orderOthers,menuInfo:t.menuInfo,showModal:t.show,prodSettingList:t.prodSettingList,promotionListSort:t.promotionListSort,promotionList:t.promotionList,voucherPackList:t.voucherPackList,amount:t.cartAmount(i)}})]}}],null,!0)})],1):o("div",t._l(t.productListSort(e),(function(r,i){return o("menu-prod-block",{key:"menu-prod-block-"+r,class:{"border-b-list":i<t.productListSort(e).length-1},attrs:{menu:t.menu,prodId:r,storeInfo:t.storeInfo,layout:t.layout,iconList:t.iconList,imgList:t.imgList,categoryId:e[t.schema.category.product_id],disableList:t.disableList,orderInfo:t.orderInfo,orderId:t.orderId,orderOthers:t.orderOthers,menuInfo:t.menuInfo,showModal:t.show,prodSettingList:t.prodSettingList,promotionListSort:t.promotionListSort,promotionList:t.promotionList,voucherPackList:t.voucherPackList,amount:t.cartAmount(r)}})})),1)])])])],1)}))],2),t.$q.screen.lt.sm&&t.block_menu_show?o("div",{staticClass:"mask"}):t._e(),o("q-scroll-observer",{attrs:{debounce:"1"},on:{scroll:t.scrollList}})],1)])},y=[],w=(o("55dd"),o("8615"),o("b178")),x=o("791e"),k=o("5648"),$=w["i"].setScrollPosition,C=w["i"].getScrollTarget,q={components:{"menu-prod-block":k["a"]},props:{disableList:Object,iconList:Object,imgList:[Array,Object],layout:Number,menu:Object,menuInfo:Object,orderId:[Number,String],orderInfo:Object,orderOthers:Object,prodSettingList:Object,recommendedList:Object,promotionList:Object,storeInfo:Object,top:Number,voucherPackList:Object},mixins:[x["a"]],data:function(){return{block_menu_show:!1,img_loading:!1,is_group_list:[],position:0,select:{category:""},show:{modal:!1}}},watch:{"$q.screen.height":function(){var t=c()(n.a.mark((function t(){return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$nextTick();case 2:this.setWaterfall();case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),"$q.screen.width":function(){var t=c()(n.a.mark((function t(){return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$nextTick();case 2:this.setWaterfall();case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),categoryList:function(){var t=c()(n.a.mark((function t(){return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$nextTick();case 2:this.setWaterfall();case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),recommendedList:function(){var t=c()(n.a.mark((function t(){return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$nextTick();case 2:this.setWaterfall();case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),"select.category":function(){var t="category-"+this.select.category,e=this.$refs[t][0],o=C(this.$refs.grid),r=this.top+e.offsetTop,i=1;$(o,r,i)}},computed:{chosenProducts:function(){return this.$store.state.cart.products},categoryCartAmount:function(){var t={};return this.chosenProducts.forEach((function(e){var o=e.categoryId.toString();Object.keys(t).includes(o)?t[e.categoryId]=t[e.categoryId]+e.num:t[e.categoryId]=e.num})),t},recommendedCartAmount:function(){var t=this,e={};return this.recommendedAmount.total&&this.chosenProducts.length&&this.chosenProducts.forEach((function(o){var r=function(r){t.recommendedListSort[r].forEach((function(i){var s=t.productList[i][t.schema.product.group_id];s?t.productList[o.id][t.schema.product.group_id]===s&&(e[r]=e[r]?e[r]+o.num:o.num):o.id===i&&(e[r]=e[r]?e[r]+o.num:o.num)}))};for(var i in t.recommendedListSort)r(i)})),e},recommendedAmount:function(){var t={total:0},e=this;for(var o in this.recommendedListSort){t[o]=0;var r=e.recommendedListSort[o];r.forEach((function(r){e.getProdCategory(r)&&(t[o]++,t.total++)}))}return t},recommendedListSort:function(){var t=this,e=this,o={},r=e.schema.product,i=this.schema.category,s=function(s){var n=e.recommendedList[s],a=[];n.forEach((function(o){var s=t.categoryListSort.find((function(t){return t[i.product_list].indexOf(o)>-1}));if(e.productList[o]&&s){var n=e.productList[o][r.group_id];n?e.productListSort(s).filter((function(t){e.productList[t][r.group_id]===n&&a.push(t)})):e.productListSort(s).indexOf(o)>-1&&a.push(o)}}));var c=a.filter((function(t,e,o){return o.indexOf(t)===e})),d=c.length,u=10;d>u&&c.splice(u,d-u),o[s]=c};for(var n in this.recommendedList)s(n);return o},recommendedListSortHandler:function(){var t={};for(var e in this.recommendedListSort)this.recommendedAmount[e]&&this.recommendedAmount.total&&3!==this.storeInfo.store_mode&&(t[e]=this.recommendedListSort[e]);return t},recycleScrollerOn:function(){return this.$store.state.recycleScroller.on},promotionCartAmount:function(){var t=this,e={};return this.promotionAmount.total&&this.chosenProducts.length&&this.chosenProducts.forEach((function(o){var r=function(r){t.promotionList[r].forEach((function(t){o.id===t&&(e[r]=e[r]?e[r]+o.num:o.num)}))};for(var i in t.promotionList)r(i)})),e},promotionAmount:function(){var t=this,e={total:0};for(var o in this.promotionList){e[o]=0;var r=this.promotionListSort[o];Object.keys(r).map(Number).forEach((function(r){t.getProdCategory(r)&&(e[o]++,e.total++)}))}return e},promotionListSort:function(){var t=this,e={},o=this.schema.product,r=this.schema.category,i=function(i){var s=t.promotionList[i],n={};s.forEach((function(e){var i=t.categoryListSort.find((function(t){return t[r.product_list].indexOf(e)>-1}));if(t.productList[e]&&i){var s=t.productList[e][o.group_id];s?t.productListSort(i).forEach((function(r){var i=r.toString();t.productList[i][o.group_id]===s&&(Object.keys(n).includes(i)?n[i].push(e):n[i]=[e])})):t.productListSort(i).indexOf(e)>-1&&(n[e]=[e])}})),e[i]=n};for(var s in this.promotionList)i(s);return e},showCategoryBar:function(){return this.position>this.top},hasImg:function(){switch(this.layout){case this.layoutType.picClick:case this.layoutType.picShow:case this.layoutType.picOutBig:return!0;default:return!1}},layoutType:function(){return{basic:this.$config.layout_type.basic,picClick:this.$config.layout_type.pic_click,picShow:this.$config.layout_type.pic_show,picOutBig:this.$config.layout_type.pic_out_big,line:this.$config.layout_type.line}},categoryListSort:function(){if(!this.categoryList||!this.schema||!this.schema.category)return[];var t=Object.values(this.categoryList),e=this.schema.category,o=function(t){return t?Object.values(t).map((function(t){return t.map((function(t){return t.product_id}))})).flat():[]},r=o(this.disableList?this.disableList.product:null),i=o(this.disableList&&this.disableList.todaySchedule?this.disableList.todaySchedule.product:null),s=this.storeInfo&&2===this.storeInfo.menu_stop_sale_type,n=this.storeInfo&&2===this.storeInfo.menu_stop_sale_today_type;return t=t.map((function(t){var o=t[e.product_list];return o&&Array.isArray(o)&&o.length&&(o=o.filter((function(t){return!(s&&r.includes(t))&&!(n&&i.includes(t))}))),t[e.product_list]=o,t})).filter((function(t){return t[e.product_list]&&t[e.product_list].length&&t[e.is_visible]&&t[e.is_enable]})).sort((function(t,o){return t[e.sort]-o[e.sort]})),t},categoryList:function(){return this.menu.category_list_json.data},productList:function(){return this.menu.product_list_json.data},blockList:function(){return this.menu.block_list_json.data},adjustList:function(){return this.menu.adjust_list_json.data},optionList:function(){return this.menu.option_list_json.data},combineList:function(){return this.menu.combine_list_json.data},schema:function(){return{category:this.menu.category_list_json.schema,product:this.menu.product_list_json.schema,block:this.menu.block_list_json.schema,adjust:this.menu.adjust_list_json.schema,option:this.menu.option_list_json.schema,combine:this.menu.combine_list_json.schema}},itemSize:function(){var t=0;switch(this.layout){case this.layoutType.picClick:case this.layoutType.picShow:t=65;break;case this.layoutType.picOutBig:t=115;break;case this.layoutType.basic:case this.layoutType.line:default:t=this.$q.screen.lt.md?58:50;break}return t}},mounted:function(){var t=c()(n.a.mark((function t(){var e=this;return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$nextTick();case 2:setTimeout((function(){e.setWaterfall()}),500);case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),methods:{cartAmount:function(t){var e=this,o=0,r=this.productList[t][this.schema.product.group_id];return this.chosenProducts.forEach((function(i){r?e.productList[i.id][e.schema.product.group_id]===r&&(o+=i.num):i.id===t&&(o+=i.num)})),o},promoteProductCartAmount:function(t,e){var o=this,r=0,i=this.productList[t][this.schema.product.group_id];return this.chosenProducts.forEach((function(s){i?o.productList[s.id][o.schema.product.group_id]===i&&o.promotionListSort[e][t].includes(s.id)&&(r+=s.num):s.id===t&&(r+=s.num)})),r},selectBlockMenu:function(t){this.select["category"]=t,this.block_menu_show=!1},getCategoryName:function(t,e){var o=e[this.schema.category.product_id];if(o&&this.prodSettingList){var r=this.prodSettingList[o];if(r&&r.alias_list.length)return r.alias_list[0]}return t},getProdCategory:function(t){var e=0,o=this.schema.category,r=this.schema.product;for(var i in this.categoryList){var s=this.categoryList[i],n=this.productList[t],a=s[o.product_list],c=a.find((function(e){return e===t})),d=s[o.is_enable]&&s[o.is_visible],u=n&&n[r.is_enable]&&n[r.is_visible];if(c&&d&&u){e=parseInt(i,10);break}}return e},scrollList:function(t){!t.position&&this.show.modal||(this.position=t.position)},prodsCount:function(t){return t[this.schema.category.product_list].length},productListSort:function(t){var e=this,o=e.schema.product,r=e.schema.category,i=t[this.schema.category.product_list],s=[],n={},a=[];for(var c in i=i.filter((function(i,a){var c=e.productList[i][o.is_enable],d=e.productList[i][o.is_visible],u=e.productList[i][o.group_id];if(u&&c&&d){var l=n[u],h={prod:i,index:a};l||(n[u]=[]),n[u].push(h)}if(c&&d){var m=t[r.product_id],f=e.disableList.product[m];if(f&&f.forEach((function(t){var e=t.product_id;if(u&&i===e){var o=n[u].findIndex((function(t){return t.prod===i}));n[u][o].disable=!0}else i===e&&s.push(i)})),3!==e.storeInfo.store_mode)return i;var p=e.voucherPackList;for(var _ in p)return Number(_)===i?i:null}})),n){for(var d=0,u=0,l=n[c],h=0;h<l.length;h++)l[h].disable&&(h!==l.length-1||u)?(d++,a.push(l[h].prod)):!l[h].disable&&u?(d++,a.push(l[h].prod)):(l[h].disable&&d++,u++);if(d===l.length)for(var m=0;m<l.length;m++)s.push(l[m].prod)}if(2===e.storeInfo.menu_stop_sale_type){var f=s;a.length&&(f=s.concat(a)),f.forEach((function(t){i.indexOf(t)>-1&&i.splice(i.indexOf(t),1)}))}else a.forEach((function(t){i.indexOf(t)>-1&&i.splice(i.indexOf(t),1)}));return i=i.sort((function(t,o){return e.productList[t][e.schema.product.sort]-e.productList[o][e.schema.product.sort]})),i},setWaterfall:function(){this.$refs.grid&&Object.keys(this.categoryList).length&&this.$q.screen.gt.sm&&window.waterfall(this.$refs.grid)}}},L=q,I=(o("4862"),o("2877")),S=Object(I["a"])(L,b,y,!1,null,"bae75264",null),O=S.exports,P=o("fb01"),T=o("0802"),j=o("55df"),A=o("4ebd"),M=o.n(A),z=o("0c6b"),D=o("4769"),B=o("e999"),N=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"flex items-center nd-btn",class:t.bClass,on:{click:t.clickEvent}},[t.icon?o("nd-icon",{staticStyle:{margin:"0px"},attrs:{color:t.iColor,className:t.iconClass,name:t.icon,size:t.iconSize}}):t._e(),t.text?o("div",{staticClass:"nd-pl-1"},[t._v(t._s(t.text))]):t._e()],1)},E=[],H=o("5473"),V={name:"NdBtn",props:{text:{type:String},border:{type:Boolean,default:!1},rounded:{type:Boolean,default:!1},color:{type:String},btnClass:{type:String},icon:{type:String},iconColor:{type:String},iconClass:{type:String},iconSize:{type:String,default:"1.25rem"},disabled:{type:Boolean,default:!1}},components:{"nd-icon":H["default"]},computed:{bClass:function(){var t=[];return this.color&&t.push(this.color),this.border&&t.push("border"),this.rounded&&t.push("rounded"),this.disabled||t.push("cursor-pointer"),this.btnClass&&t.push(this.btnClass),t.join(" ")},iColor:function(){return this.iconColor||this.color||""}},methods:{clickEvent:function(){this.disabled||this.$emit("clickEvent")}}},F=V,G=(o("13b1"),Object(I["a"])(F,N,E,!1,null,"524335c2",null)),U=G.exports,R=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"full-width"},[t.$q.screen.lt.md?o("div",{class:{"fixed-bar":t.showCategoryBar}},[o("div",{staticClass:"row text-white b-bg"},[o("div",{staticClass:"col overflow-hidden"},[o("q-tabs",{staticClass:"text-white b-bg category-select-block",attrs:{"inline-label":"",dense:""},model:{value:t.select.category,callback:function(e){t.$set(t.select,"category",e)},expression:"select.category"}},[t._l(t.categoryListSort,(function(e,r){return t.block_menu_show?t._e():o("q-tab",{key:"category-bar-"+r,attrs:{label:e.name,name:e.id}},[t.categoryCartAmount[e.id]?o("div",{staticClass:"q-ml-xs flex font-size-caption product-amount bg-white"},[o("span",{staticClass:"b-color"},[t._v("\n                "+t._s(t.categoryCartAmount[e.id])+"\n              ")])]):t._e()])})),t.block_menu_show?o("q-tab",{staticClass:"q-pl-xl",attrs:{focus:"",label:"全部分類"}}):t._e()],2)],1),o("div",{staticClass:"b-bg"},[o("q-btn",{staticClass:"q-px-sm btn-menu-more",attrs:{dense:"",size:"13px","text-color":"white",icon:t.block_menu_show?"fas fa-angle-up":"fas fa-angle-down"},on:{click:function(e){t.block_menu_show=!t.block_menu_show}}})],1)]),t.block_menu_show?o("div",{staticClass:"bg-white block-meun"},[o("div",{staticClass:"row"},t._l(t.categoryListSort,(function(e,r){return o("div",{key:"block-bar-"+r,staticClass:"col-6 block-meun-bg"},[o("div",{class:["block-meun-list",t.select.category===e.id?"b-bg text-white":""],on:{click:function(o){return t.selectBlockMenu(e.id)}}},[t._v("\n            "+t._s(e.name)+"\n            "),t.categoryCartAmount[e.id]?o("div",{staticClass:"q-ml-xs flex font-size-caption product-amount",class:t.select.category===e.id?"bg-white b-color":"b-bg text-white"},[o("span",[t._v("\n                "+t._s(t.categoryCartAmount[e.id])+"\n              ")])]):t._e()])])})),0)]):t._e()]):t._e(),o("div",{staticClass:"q-pb-md"},[o("div",{ref:"grid",class:["full-width",{"mt-36":t.showCategoryBar&&t.$q.screen.lt.md}]},t._l(t.categoryListSort,(function(e,r){return o("div",{key:"category-"+r,ref:"category-"+e.id,refInFor:!0},[o("div",{staticClass:"q-py-sm q-px-md q-pb-md-lg q-mb-md-sm"},[o("div",{staticClass:"q-pb-md b-color nd-font-weight-medium",class:t.$q.screen.lt.md?"nd-font-size-body":"nd-font-size-title"},[t._v("\n            "+t._s(e.name)+"\n          ")]),o("div",{staticClass:"row q-col-gutter-md"},t._l(e.product_map,(function(r,i){return o("div",{key:"menu-prod-block-"+r.id,staticClass:"col-12 col-sm-6 col-md-4"},[o("menu-prod-block",{attrs:{prodInfo:r,prodId:r.id,storeInfo:t.storeInfo,imgList:t.imgList,categoryId:e.id,disableList:t.disableList,orderInfo:t.orderInfo,amount:t.cartAmount(r.id)},on:{showModal:t.openProdModal}})],1)})),0)])])})),0),t.$q.screen.lt.sm&&t.block_menu_show?o("div",{staticClass:"mask"}):t._e(),o("q-scroll-observer",{attrs:{debounce:"1"},on:{scroll:t.scrollList}})],1),o("menu-modal",{attrs:{"show-modal":t.show.menuModal,prodId:t.modalProdId,storeInfo:t.storeInfo,itemSetUid:t.itemSetUid,orderId:t.orderId,orderInfo:t.orderInfo},on:{"update:showModal":function(e){return t.$set(t.show,"menuModal",e)},"update:show-modal":function(e){return t.$set(t.show,"menuModal",e)}}})],1)},J=[],W=o("1329"),Y=function(){var t=this,e=t.$createElement,o=t._self._c||e;return t.categoryId?o("div",{directives:[{name:"show",rawName:"v-show",value:t.searchShow,expression:"searchShow"},{name:"ripple",rawName:"v-ripple",value:!0,expression:"true"}],staticClass:"border border-around cursor-pointer",on:{click:t.openProdModal}},[o("div",[o("div",{staticClass:"row"},[o("div",{staticClass:"col flex column justify-between nd-p-3"},[o("div",{staticClass:"font-size-subtitle-2 text-weight-medium ellipsis-2-lines"},[2===t.prodInfo.type?o("span",{staticClass:"border-label font-size-overline text-primary nd-mr-1"},[t._v("\n            套票\n          ")]):t._e(),t._v("\n          "+t._s(t.prodInfo.name)+"\n        ")]),o("div",{staticClass:"flex items-center"},[o("div",{staticClass:"text-weight-medium"},[t._v("$"+t._s(parseInt(t.prodInfo.total_sale_money,10)||0))]),t.prodInfo.total_sale_money!==t.prodInfo.total_money?o("div",{staticClass:"font-size-caption text-strike text-grey-7 nd-ml-1"},[t._v("\n            $"+t._s(parseInt(t.prodInfo.total_money,10)||0)+"\n          ")]):t._e()])]),o("div",{staticClass:"flex col-auto vourcher-img"},[t.prodInfo.image?o("img",{staticClass:"full-height",attrs:{src:t.prodInfo.image,alt:""}}):o("img",{staticClass:"full-height",attrs:{src:t.noProductImage,alt:"no product image"}}),t.amount?o("div",{staticClass:"absolute product-amount-block"},[o("div",{staticClass:"flex font-size-caption product-amount b-bg"},[o("span",{staticClass:"text-white"},[t._v(t._s(t.amount))])])]):t._e()])])])]):t._e()},K=[],Z=(o("4917"),o("e72b")),Q=o.n(Z),X={name:"NdMenuProdBlockVoucher",props:{prodInfo:Object,prodId:Number,storeInfo:Object,categoryId:Number,disableList:Object,searchProd:String,amount:Number},mixins:[x["a"]],data:function(){return{show:{modal_prod:!1},editProd:void 0}},methods:{clearEditProd:function(t){t&&(this.editProd=void 0)},openProdModal:function(){var t=c()(n.a.mark((function t(){return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.$emit("showModal",this.prodId),this.setGATag("select_content",this.prodId);case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},created:function(){var t=c()(n.a.mark((function t(){var e;return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=this.$q.sessionStorage.getItem(this.$config.prodId),e!==this.prodId){t.next=7;break}return this.editProd=JSON.parse(this.$q.sessionStorage.getItem(this.$config.adjusts)),t.next=5,this.openProdModal();case 5:this.$q.sessionStorage.remove(this.$config.prodId),this.$q.sessionStorage.remove(this.$config.adjusts);case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),computed:{noProductImage:function(){return Q.a},searchShow:function(){return!this.searchProd||this.prodInfo.name.match(this.searchProd)}}},tt=X,et=(o("738e"),Object(I["a"])(tt,Y,K,!1,null,"98ea3434",null)),ot=et.exports,rt=w["i"].setScrollPosition,it=w["i"].getScrollTarget,st={components:{"menu-prod-block":ot,"menu-modal":W["a"]},props:{disableList:Object,imgList:[Array,Object],menu:Array,orderInfo:Object,storeInfo:Object,orderId:[Number,String],top:Number},mixins:[x["a"]],data:function(){return{block_menu_show:!1,position:0,select:{category:""},show:{menuModal:!1},modalProdId:0,itemSetUid:0}},watch:{"select.category":function(){var t="category-"+this.select.category,e=this.$refs[t][0],o=it(this.$refs.grid),r=this.top+e.offsetTop,i=1;rt(o,r,i)}},computed:{chosenProducts:function(){return this.$store.state.cart.vouchers},categoryId:function(){var t={};return this.menu.forEach((function(e){e.product_map.forEach((function(o){t[o.id]=e.id}))})),t},categoryCartAmount:function(){var t=this,e={};return this.chosenProducts.forEach((function(o){var r=t.categoryId[o.id]?t.categoryId[o.id].toString():"";Object.keys(e).includes(r)?e[r]=e[r]+o.num:e[r]=o.num})),e},showCategoryBar:function(){return this.position>this.top},categoryListSort:function(){return this.menu}},mounted:function(){var t=c()(n.a.mark((function t(){return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$nextTick();case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),methods:{cartAmount:function(t){var e=0;return this.chosenProducts.forEach((function(o){o.id===t&&(e+=o.num)})),e},selectBlockMenu:function(t){this.select["category"]=t,this.block_menu_show=!1},scrollList:function(t){t.position&&(this.position=t.position)},openProdModal:function(t){this.modalProdId=t,this.show.menuModal=!0}}},nt=st,at=Object(I["a"])(nt,R,J,!1,null,"3fcdea8d",null),ct=at.exports,dt=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"full-width"},[o("div",{staticClass:"menu-list full-width flex column"},t._l(t.categoryListSort,(function(e,r){return o("div",{key:"category-"+r,staticClass:"item full-width"},[o("div",[o("ul",{staticClass:"full-width"},t._l(e.product_map,(function(r,i){return o("menu-prod-block",{key:"menu-prod-block-"+r.id,staticClass:"nd-my-2",attrs:{prodInfo:r,prodId:r.id,searchProd:t.searchProd,storeInfo:t.storeInfo,categoryId:e.id,disableList:t.disableList,orderInfo:t.orderInfo},on:{openProdModal:t.openProdModal}})})),1)])])})),0)])},ut=[],lt={components:{"menu-prod-block":ot},props:["menu","storeInfo","iconList","imgList","disableList","searchProd","orderInfo","orderId","menuInfo","prodSettingList","voucherPackList","promotionList"],mixins:[x["a"]],methods:{openProdModal:function(){this.$emit("showModal",this.prodId),this.setGATag("select_content",this.prodId)}},computed:{categoryListSort:function(){return this.menu}}},ht=lt,mt=Object(I["a"])(ht,dt,ut,!1,null,null,null),ft=mt.exports,pt=o("9a59"),_t=o.n(pt),gt=o("6399"),vt=o.n(gt),bt=o("467fc"),yt=o("7073"),wt=o("e7c1"),xt=o("a62e"),kt=o("98c2"),$t=o("6abe"),Ct=$t["PhoneNumberUtil"].getInstance();function qt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"TW",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"E164";if(!t)return"";try{var r=Ct.parseAndKeepRawInput(t,e);if(!Ct.isValidNumber(r))return t;var i=$t["PhoneNumberFormat"][o];return Ct.format(r,i)}catch(s){return t}}var Lt=qt,It=o("2b0e"),St=o("4eb5"),Ot=o.n(St);function Pt(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,r)}return o}function Tt(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?Pt(Object(o),!0).forEach((function(e){h()(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):Pt(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}Ot.a.config.autoSetContainer=!0,It["default"].use(Ot.a);var jt={inject:["reload"],name:"NdMenuV2View",props:["changeImg"],components:{"store-detail":f["a"],"i-main-fun":p["a"],"menu-list-v2":O,"menu-list-voucher":ct,"copy-gb":m["a"],"search-list":P["a"],"search-list-voucher":ft,activity:T["default"],"delivery-service":j["default"],"i-li":z["a"],"nd-faq-list":D["a"],"nd-faq-category":B["a"],"nd-icon":H["default"],"nd-btn":U,"nd-home-v2-banner":function(){return Promise.all([o.e(1),o.e(0)]).then(o.bind(null,"e980"))}},mixins:[x["a"],bt["a"],yt["a"],wt["a"],xt["a"]],meta:function(){return{title:this.title,meta:{description:{name:"description",content:this.description},keywords:{name:"keywords",content:this.keywords},equiv:{"http-equiv":"Content-Type",content:"text/html; charset=UTF-8"},ogtitle:{property:"og:title",content:this.title},ogdescription:{property:"og:description",content:this.description},ogimage:{property:"og:image",content:this.image},ogimagealt:{property:"og:image:alt",content:this.imageAlt},ogUrl:{property:"og:url",content:yt["a"].href},iname:{itemprop:"name",content:this.title},idescription:{itemprop:"description",content:this.description},iimage:{itemprop:"image",content:this.image},twittercard:{property:"twitter:card",content:"summary"},twittertitle:{property:"twitter:title",content:this.title},twitterdescription:{property:"twitter:description",content:this.description},twitterimage:{property:"twitter:image",content:this.image},twitterimagealt:{property:"twitter:image:alt",content:this.imageAlt}},link:{appIcon1:{rel:"shortcut icon",size:"36x36",href:this.image},appIcon2:{rel:"shortcut icon",size:"48x48",href:this.image},appIcon3:{rel:"shortcut icon",size:"72x72",href:this.image},appIcon4:{rel:"shortcut icon",size:"96x96",href:this.image},appIcon5:{rel:"shortcut icon",size:"128x128",href:this.image},appIcon6:{rel:"shortcut icon",size:"144x144",href:this.image},appIcon7:{rel:"shortcut icon",size:"192x192",href:this.image},appIcon8:{rel:"apple-touch-icon",size:"120x120",href:this.image},appIcon9:{rel:"apple-touch-icon",size:"152x152",href:this.image},appIcon10:{rel:"apple-touch-icon",size:"167x167",href:this.image},appIcon11:{rel:"apple-touch-icon",size:"180x180",href:this.image},appIcon12:{rel:"shortcut icon",type:"image/png",href:this.image}}}},data:function(){return{show:{activity:!1,banner:!1,error:!1,loading:!0,modal_activity:!1,modal_gb:!1,modal_search_prod:!1,modal_service:!1,modal_store_info:!1,out_of_business:!1,rest:!1,store_prepare:!1},scroll:{isTop:!0,direction:"up"},position:0,tab:"storeInfo",store:this.$route.params.store_id,store_info:{},voucher_pack_list:{},storeMode:0,slide:0,menu_info:{},menu_json:{category_list_json:{data:{},schema:{}},product_list_json:{data:{},schema:{}},block_list_json:{data:{},schema:{}},adjust_list_json:{data:{},schema:{}},option_list_json:{data:{},schema:{}},combine_list_json:{data:{},schema:{}}},recommended_list:{},promotion_list:{},voucher_menu_version:{},voucherMenu:[],icon_list:{},img_list:[],disable_list:{category:[],adjust:[],option:{},block:{},product:{},item:{}},menu_top:0,activity_list:[],is_gb:!1,share_code:"",gb_link:"",order_id:"",order_sn:"",order_info:{},order_others:{},productOrder:{order_id:"",order_sn:"",order_info:{},order_others:{},no_menu:!1},voucherOrder:{order_id:"",order_sn:"",order_info:{},order_others:{},no_menu:!1},search_prod:"",search_prod_opt:{icon:"search",hideBottomSpace:!0},gb_info:{},mapping_list:[],prod_setting_list:{},isFavorite:!1,currentCategory:0,isShowMask:!1,categoryHeight:110,faqList:[],currentList:[],getFaqListTop:0,closeCategory:!1,searchFaq:"",searchFaqOpt:{icon:"search"},menuType:"product",tabList:[{name:"product",label:"一般商品"},{name:"voucher",label:"電子票券"}],defaultDeliveryType:null}},computed:{brandInfo:function(){return this.$store.getters["order/ubrandInfo"]},layout:function(){return this.$route.query.layout?parseInt(this.$route.query.layout,10):this.store_info.menu_layout_type?this.store_info.menu_layout_type:1},showCart:function(){return this["".concat(this.menuType,"Order")].order_id},storeStatusName:function(){switch(this.store_info.store_status){case 0:return"未營業";case 1:return"籌備中";case 3:return"休息中";case 9:return"已歇業";case 2:return"營業中";default:return""}},noOrderDate:function(){var t=this.store_info,e=v()().add(t.order_tolerance_day,"days");return!!(Date.parse(e)<Date.parse(v()(t.next_opening_date,"YYYY-MM-DD"))&&t.is_off_day)},noticeBar:function(){var t=this.store_info;return 20===t.order_status?t.order_status_reason?"門市暫停接單"+t.order_status_reason:"門市暫停接單":t.is_off_day&&(!t.order_tolerance_day||!t.is_off_allow_order)||this.noOrderDate?"門市今日公休":t.is_off_day?"門市今日公休，開放預訂":t.is_close&&(!t.is_close_allow_order||!t.order_tolerance_day)||this.noOrderDate?"門市已在"+this.getTime(2,t.order_end_time,"HH:mm")+"結束訂購":t.is_close?"門市今日結束訂購，開放預訂":t.is_preparing&&!t.is_preparing_allow_order?"門市將於"+this.getTime(2,t.order_start_time,"HH:mm")+"開始訂購":t.is_preparing?"開放預訂"+this.getTime(2,t.order_start_time,"HH:mm")+"後的訂單":t.store_status&&2!==t.store_status?"門市"+this.storeStatusName:!!t.comment&&t.comment},galleyH:function(){var t=this.$q.screen.width;return t<400?"180px":t>=400&&t<600?"200px":t>=600&&t<700?"250px":t>=700&&t<880?"280px":t>=880&&t<1024?"320px":t>=1024&&t<1560?"300px":"350px"},brannerList:function(){if(this.store_info){var t=this.store_info.banner_c_info;if(t&&t.length)return t}return[{name:1,image:M.a}]},cartAmount:function(){return"voucher"===this.menuType?this.voucherOrder.order_info.total_amount||0:this.productOrder.order_info.total_amount||0},cartMoney:function(){return"voucher"===this.menuType?this.voucherOrder.order_info.total_money||0:this.productOrder.order_info.total_money||0},curBrand:function(){var t=this;return this.domainBrandList.find((function(e){return e.brand_code===t.store_info.brand_code}))},title:function(){var t="";return t=this.store_info.name_short?"".concat(this.store_info.name_short," ").concat(this.$t("t_menu_default",{main:this.$store.getters["meta/main_short"]})):this.isUnique?this.$t("t_default_unique",{main:this.$store.getters["meta/main"]}):this.$t("t_default"),t},description:function(){return this.store_info.search_description?this.store_info.search_description:this.curBrand&&this.store_info.name&&!this.store_info.search_description?this.curBrand.brand_name_c+" "+this.store_info.name+" "+this.$t("d_menu_default"):this.store_info.brand_name&&this.store_info.name&&!this.store_info.search_description?this.store_info.brand_name+" "+this.store_info.name+" "+this.$t("d_menu_default"):this.$t("d_default")},keywords:function(){return this.curBrand?this.$t("k_menu_default")+this.curBrand.brand_name_c:this.$t("k_default")},image:function(){var t=this.store_info.image||"",e="https://cdn-order.nidin.shop/nidin2/statics/Nidin/share.png";return t||e},imageAlt:function(){var t="";return t=this.store_info.name_short?"".concat(this.store_info.name_short," ").concat(this.$t("t_menu_default",{main:this.$store.getters["meta/main_short"]})):this.isUnique?this.$t("t_default_unique",{main:this.$store.getters["meta/main"]}):this.$t("t_default"),t},openTime:function(){if(this.store_info.order_start_time){var t=this.getTime(2,this.store_info.order_start_time,"HH:mm"),e=this.getTime(2,this.store_info.order_end_time,"HH:mm");return t+" ~ "+e}return""},showAddress:function(){var t=this.store_info.address;return this.store_info.address_remark&&(t=t+" ("+this.store_info.address_remark+")"),t},favoriteIcon:function(){var t={icon:"favorite"};return this.isFavorite?t.icon=vt.a:t.icon=_t.a,t},latitude:function(){return this.$store.state.location.latitude},longitude:function(){return this.$store.state.location.longitude},voucherOpen:function(){return!(Object.keys(this.$store.state.order.gb_brief).length||!this.store_info.has_voucher_product||!this.store_info.is_allow_purchase_voucher_product)},distanceText:function(){return this.store_info.distance?this.distanceName(this.store_info.distance)+"・":""},fixHeaderMenuTab:function(){return this.position&&this.position>this.menu_top},structuredData:function(){var t,e,o,r,i,s,n=this,a=Tt({},kt["a"]);a.address.addressCountry="TW";var c=this.$store.state.location.cityAreaList.find((function(t){return t.city_code===n.store_info.city_code}))||{area_list:[]};a.address.addressLocality=c.name||"";var d=c.area_list.find((function(t){return t.area_code===n.store_info.area_code}))||{};if(a.address.addressRegion=d.name||"",this.store_info.address){var l=this.store_info.address;c&&c.name&&-1!==l.indexOf(c.name)&&(l=l.replace(c.name,"")),d&&d.name&&-1!==l.indexOf(d.name)&&(l=l.replace(d.name,"")),a.address.streetAddress=l}var h=[this.store_info.brand_logo,this.store_info.brand_photo,this.store_info.image,this.store_info.photo].filter((function(t){return t&&"string"===typeof t&&""!==t.trim()})),m=u()(new Set(h));return a.image=m,a.name=this.store_info.name||"",a.description=this.store_info.search_description||"",a.openingHours=(this.store_info.opening_times_weekly||[]).map((function(t){if(t.week_day<1||t.week_day>7)return"";var e=v()().weekday(t.week_day-1).format("dd")||"",o=v()(t.start_time,"HH:mm:ss",!0).isValid()?v()(t.start_time,"HH:mm:ss").format("HH:mm"):"",r=v()(t.end_time,"HH:mm:ss",!0).isValid()?v()(t.end_time,"HH:mm:ss").format("HH:mm"):"";return e&&o&&r?"".concat(e," ").concat(o,"-").concat(r):""})).filter((function(t){return""!==t})),a.telephone=this.store_info.tel?Lt(this.store_info.tel):"",a.email=(null===(t=this.brandInfo)||void 0===t?void 0:t.email)||(null===(e=this.store_info)||void 0===e?void 0:e.email)||"",a.url="".concat(window.location.origin,"/brand/").concat(this.store_info.brand_code,"/"),a.geo.latitude=this.store_info.latitude||"",a.geo.longitude=this.store_info.longitude||"",a.sameAs=null===(o=this.brandInfo)||void 0===o?void 0:null===(r=o.websites)||void 0===r?void 0:r.map((function(t){return t.url})),a.paymentAccepted=(null===(i=this.store_info)||void 0===i?void 0:null===(s=i.trade_types)||void 0===s?void 0:s.map((function(t){return t.name})))||[],a.aggregateRating.ratingValue=this.store_info.rating_average_star||0,a.aggregateRating.ratingCount=this.store_info.rating_order_count||0,a}},methods:{closeOrderInfoDialog:function(){var t=this;this.tab="storeInfo",this.$nextTick((function(){t.isShowMask=!1,t.show.modal_service=!1,t.categoryHeight=0,t.currentCategory=0,t.getFaqListTop=0}))},getBrandInfo:function(){var t=c()(n.a.mark((function t(){return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("order/GET_U_BRAND_INFO",this.store_info.brand_code);case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getFaqList:function(){var t=this,e="/faq/category/list",o=1;this.isOnSite&&(o=4),this.isLiffReady&&(o=2,this.isOnSite&&(o=8));var r={src_type:3,platform_type:o,store_id:this.store,brand_id:this.store_info.brand_id};this.getDataH(e,r).then((function(e){200===e.data.status&&(t.faqList=e.data.list,t.currentList=t.faqList)})).catch((function(t){}))},showMask:function(t){this.isShowMask=t},changeCategory:function(t){var e=this;this.searchFaq="",this.$nextTick((function(){e.getFaqListTop=e.$refs.category.$refs["card_"+t][0].offsetTop,e.$refs.orderInfo.$el.scrollTo({top:e.getFaqListTop,behavior:"smooth"})}))},changePanelHeight:function(){var t=this;this.$nextTick((function(){t.$refs.orderInfoCategory&&(t.categoryHeight=t.$refs.orderInfoCategory.offsetHeight+12)}))},autoRedirectStore:function(){return!(!this.store_info||!this.store_info.new_store_id)&&(this.$router.replace({name:"menu",params:{store_id:this.store_info.new_store_id}}),!0)},getMappingList:function(){var t=this;this.mapping_list=[];var e="/user/"+this.getUId+"/designatedMappingList",o={store_id:this.$route.params.store_id};this.getDataH(e,o).then((function(e){200===e.data.status&&(t.mapping_list=e.data.list,t.mapping_list.length&&(t.show.activity=!0))})).catch((function(t){}))},copyLink:function(){var t=this;this.$copyText(this.gb_link).then((function(e){t.$q.notify(t.$t("notify.copied_link"))}),(function(){})).catch((function(t){}))},clickPointMall:function(){var t="/point-mall",e={};this.isUBrand?t="/ubrand/".concat(this.isUBrand,"/point-mall"):this.isUStore?t="/ustore/".concat(this.isUStore,"/point-mall"):e.store=this.store;var o=this.$router.resolve({path:t,query:e}),r=o.href;this.$q.platform.is.mobile&&this.$store.state.app.liff.ready?this.$router.push({path:t,query:e}):window.open(r,"_blank")},clickActivity:function(){this.show.modal_activity=!0,this.setGATag("view_menu_promotion")},clickService:function(){this.show.modal_service=!0},clickSearch:function(t){this["".concat(t,"Order")].no_menu||(this.show.modal_search_prod=!0)},clickMemberCard:function(){this.store_info.membership_group_info&&this.store_info.membership_group_info.group_id&&this.$router.push({name:"MemberCardIntro",query:{group_id:this.store_info.membership_group_info.group_id}})},clearOrder:function(t){this.order_id="",this.order_sn="",this.order_info={},this.voucherOrder.order_id="",this.voucherOrder.order_sn="",this.voucherOrder.order_info={},this.productOrder.order_id="",this.productOrder.order_sn="",this.productOrder.order_info={},t()},checkGB:function(){var t=this,e=this;if(!this.isLogin||this.isPhoneVerity&&!this.share_code){var o="手機驗證完就可以揪團囉！";this.isLogin||(o="登入並"+o),this.$q.dialog({class:"nidin-dialog",title:e.$t("dialog.notice"),message:o,ok:{label:e.$t("footer.login"),color:"primary",textColor:"white"},cancel:{label:e.$t("dialog.ok"),color:"gray-6",textColor:"gray-2"}}).onOk((function(){t.isLogin?t.isPhoneVerity&&e.$router.push("/certification"):e.$router.push("/login")}))}else this.productOrder.no_menu||(this.is_gb||this.$route.params.share_code?e.show.modal_gb=!0:(this.is_gb=!0,this.productOrder.order_id?this.toGroupBuy():this.newGbOrder()))},setGBLink:function(t,e){t&&(this.share_code=t);var o=window.location.href.split("/"),r=o[0]+"//"+o[2]+"/gb/menu/"+this.store+"/"+this.share_code;this.isUnique&&(r+="?",this.isUStore&&(r=r+"u_store_id="+this.isUStore),this.isUBrand&&(r=r+"u_brand_code="+this.isUBrand)),this.gb_link=r,e||(this.show.modal_gb=!0)},toGroupBuy:function(){var t=this,e="/carts/"+this.productOrder.order_id+"/toGroupBuy";this.postDataH(e,null).then((function(e){if(200===e.data.status){var o=e.data.group_buy_info.group_buy_list[0];t.setGBLink(o.share_code)}})).catch((function(t){}))},newGbOrder:function(){var t=this,e={brand_id:t.store_info.brand_id,store_id:t.store_info.id,menu_id:t.menu_info.menu_id,menu_ver_stamp:t.menu_info.version.stamp,order_type:2,is_empty:1,delivery_type:this.defaultDeliveryType},o="/carts/item";this.postDataH(o,e).then((function(e){if(200===e.data.status){t.productOrder.order_id=e.data.order_id,t.productOrder.order_sn=e.data.order_sn;var o=t.$store.state.order.cart_amount+1;t.$store.commit("order/setCartAmount",o),t.menuType="product",t.setGBLink(e.data.sharing_code)}else t.is_gb=!0})).catch((function(t){}))},scrollMenuTop:function(t){var e=0,o=this.$refs.menu;while(o)e+=o.offsetTop-o.scrollLeft+o.clientTop,o=o.offsetParent;this.menu_top=e-60,this.position=t.position},scrollEvent:function(t){this.scroll.isTop=0===t.position,this.scroll.direction=t.direction},getDisableProd:function(){var t=c()(n.a.mark((function t(){var e,o,r,i,s,a,c,d,u,l;return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e="/store/".concat(this.store,"/disableItemsRelationNew"),t.next=4,this.getData(e,null);case 4:o=t.sent,o&&o.data&&200===o.data.status&&(r=o.data.option_list||[],i=o.data.product_list||{},s=o.data.package_list||[],a=o.data.block_list||[],c=o.data.schedule_info.setting_list&&Array.isArray(o.data.schedule_info.setting_list)?{}:o.data.schedule_info.setting_list,d=o.data.schedule_info.relation&&Array.isArray(o.data.schedule_info.relation)?{product_list:{},package_list:{}}:o.data.schedule_info.relation,u=o.data.today_schedule_info&&Array.isArray(o.data.today_schedule_info)?{product_list:{},package_list:{}}:o.data.today_schedule_info,l={category:o.data.category_list||{},adjust:this.setDisLayout("adjust",o.data.adjust_list||{}),option:this.setDisLayout("option",r),block:this.setDisLayout("block",a),product:this.setDisLayout("product",i.category||{},s.category||{}),item:this.setDisLayout("item",i.block||{}),setting_list:c||{},schedule:this.setScheduleLayout(d),todaySchedule:this.setScheduleLayout(u)},this.disable_list=l,this.show.loading=!1),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0);case 11:case"end":return t.stop()}}),t,this,[[0,8]])})));function e(){return t.apply(this,arguments)}return e}(),setScheduleLayout:function(t){return t=t||{},{category:t.category_list||[],adjust:this.setDisLayout("adjust",t.adjust_list||[]),option:this.setDisLayout("option",t.option_list||[]),block:this.setDisLayout("block",t.block_list||[]),product:this.setDisLayout("product",t.product_list.category||[],t.package_list.category||[]),product_open:this.setDisLayout("product_open",t.product_list.category||[],t.package_list.category||[]),item:this.setDisLayout("item",t.product_list.block||[])}},setCrazyAd:function(t){if(t){var e=this.$q.sessionStorage.getItem(this.$config.prodId)||"";e||(this.$store.commit("crazyAd/SET_CURRENT","store"),this.$store.commit("crazyAd/SET_CRAZY_AD",t),this.$store.commit("crazyAd/SET_OPEN",!0))}},setDisLayout:function(t,e,o){var r={};if("adjust"===t)for(var i in e)r[e[i]]=!0;if("option"===t){var s=function(t){r[t]={},e[t].forEach((function(e){r[t][e.product_id]=!0}))};for(var n in e)s(n)}if("block"===t)for(var a in e)e[a].forEach((function(t){r[t.product_id]=!0}));if("product"===t){for(var c in e)r[c]=e[c];for(var d in o)r[d]=[].concat(u()(r[d]||[]),u()(o[d]||[]))}if("product_open"===t){for(var l in e)e[l].forEach((function(t){r[t.product_id]=t}));for(var h in o)o[h].forEach((function(t){r[t.product_id]=t}))}if("item"===t){var m=function(t){r[t]={},e[t].forEach((function(e){r[t][e.product_id]=!0}))};for(var f in e)m(f)}return r},setMenu:function(){var t=this.$q.localStorage.getItem("Nidin_"+this.store+"_menu");this.menu_json=JSON.parse(t)},getMenuJson:function(t){var e=this,o="/store/"+this.store+"/onShelfMenu";if(e.$q.platform.is.iphone&&e.$q.platform.is.safari)for(var r in e.$q.localStorage.getAll())r.includes("Nidin")?r.includes("menu")?e.$q.localStorage.remove(r):r.includes("_prod_setting")&&e.$q.localStorage.remove(r):e.$q.localStorage.remove(r);this.getData(o,null).then((function(o){200===o.data.status&&(e.$q.localStorage.set("Nidin_"+e.store+"_menu_version",t),e.$q.localStorage.set("Nidin_"+e.store+"_menu",JSON.stringify(o.data.menu)),e.setMenu())})).catch((function(t){for(var o in e.$q.localStorage.getAll())o.includes("Nidin")?o.includes("menu")?e.$q.localStorage.remove(o):o.includes("_prod_setting")&&e.$q.localStorage.remove(o):e.$q.localStorage.remove(o);e.reload()}))},checkMenuVersion:function(){var t=c()(n.a.mark((function t(){var e,o=this;return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e="/store/"+this.store+"/onShelfMenuVer",t.next=3,this.getData(e,null).then((function(t){var e=30601;if(200===t.data.status){o.menu_info=t.data,o.$q.localStorage.set(o.$config.menuId,t.data.menu_id);var r=t.data.version.stamp.toString(),i=o.$q.localStorage.getItem("Nidin_"+o.store+"_menu_version");r!==i?o.getMenuJson(r):o.$q.platform.is.iphone&&o.$q.platform.is.safari?o.getMenuJson():o.$q.localStorage.getItem("Nidin_"+o.store+"_menu")?o.setMenu():o.getMenuJson(),o.isPhoneVerity||o.getRcommendProducts()}else t.data.status===e&&(o.show.store_prepare=!0,o.show.loading=!1)})).catch((function(){1===o.store_info.store_status?o.show.store_prepare=!0:o.productOrder.no_menu=!0,o.show.loading=!1}));case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getStoreInfo:function(){var t=c()(n.a.mark((function t(){var e,o,r=this;return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e="/store/".concat(this.store,"/info"),o={},this.curLocation.city_code&&(o.city_code=this.curLocation.city_code),this.latitude&&this.longitude&&(o.latitude=this.latitude,o.longitude=this.longitude),t.next=6,this.getData(e,o).then((function(t){if(200===t.data.status&&t.data.id){r.store_info=t.data;var e=r.autoRedirectStore();if(e)return;t.data.has_location_banner&&r.getCurLocation(),r.store_info.discount_today_info&&r.store_info.discount_today_info.length&&(r.show.activity=!0,r.getPromotionProducts(r.store_info).then((function(t){r.promotion_list=t}))),r.store_info.allowance_info&&r.store_info.allowance_info.length&&(r.show.activity=!0);var o=r.store_info.store_status;switch(o){case 0:r.show.store_prepare=!0,r.show.loading=!1;break;case 3:r.show.rest=!0,r.show.loading=!1;break;case 9:r.show.out_of_business=!0,r.show.loading=!1;break;default:break}r.checkOffDay(),r.changeImg(r.store_info.brand_logo),r.handlerTheme({step:2,type:3,brand:t.data.brand_code,menu:t.data.id,primary:t.data.brand_main_color_code,secondary:t.data.brand_sub_color_code,store:t.data.id}),r.storeMode=r.store_info.store_mode,r.isFavorite=r.store_info.is_favorite;var i=t.data.banner_modal_info||[];r.setCrazyAd(i)}else r.$router.replace("/")})).catch((function(){r.$router.replace("/")})).finally((function(){r.$store.commit("modalManager/REGISTER_MODAL","crazyAd"),r.$store.dispatch("modalManager/sortAndShowModal",r.setBrandCode)}));case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getProductIcons:function(){var t=this,e="/store/"+this.store+"/productIcons";this.store_info.show_menu_product_icon&&this.getData(e,null).then((function(e){200===e.data.status&&(t.icon_list=e.data)})).catch((function(t){}))},getProductSettion:function(){var t=this,e=this,o="/store/"+this.store+"/productSetting";this.getData(o,null).then((function(o){if(200===o.data.status){var r=o.data.product_list;e.$q.localStorage.remove("Nidin_"+t.store+"_prod_setting",r),Array.isArray(r)||(e.prod_setting_list=r,e.$q.localStorage.set("Nidin_"+t.store+"_prod_setting",r))}})).catch((function(t){}))},getProductImgs:function(){var t=this,e="/store/"+this.store+"/productImages";this.getData(e,null).then((function(e){200===e.data.status&&(t.img_list=e.data.product_list)})).catch((function(t){}))},getRcommendProducts:function(){var t=this,e="/user/"+this.getUId+"/recommendedStoreProductInfo/"+this.store;this.getDataH(e,null).then((function(e){200===e.data.status&&(t.recommended_list=e.data.info)})).catch((function(t){}))},getStoreActivityList:function(){var t=this,e="/store/"+this.store+"/activityList";this.getData(e,null).then((function(e){200===e.data.status&&(t.activity_list=e.data.list,t.activity_list.length&&(t.show.activity=!0))})).catch((function(t){}))},getOrderInfo:function(){var t=c()(n.a.mark((function t(){var e,o,r=this;return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=this.productOrder.order_id,o="/order/"+e+"/info",this.getData(o,null).then((function(t){if(200===t.data.status){r.productOrder.order_id=e,r.productOrder.order_sn=t.data.order_info.basic.order_sn,r.productOrder.order_info=t.data.order_info.basic,r.productOrder.order_others=t.data,r.$store.commit("cart/clearProducts"),t.data.order_info.product.forEach((function(t){r.$store.commit("cart/addProduct",{id:t.product_id,num:t.amount,categoryId:t.parent_product_id})}));var o=r.productOrder.order_info.order_type;2!==o&&3!==o||(r.getShareByOrderId(),r.is_gb=!0);var i=r.productOrder.order_info.store_id;if(0!==r.productOrder.order_info.status)r.$q.dialog({class:"nidin-dialog",title:r.$t("dialog.notice"),message:"此訂單無法查詢",ok:{label:r.$t("dialog.ok"),color:"primary",textColor:"white"},persistent:!0}).onOk((function(){r.clearOrder((function(){r.$router.replace({path:"/menu/"+i})}))}));else if(i!==parseInt(r.store,10))r.$q.dialog({class:"nidin-dialog",title:r.$t("dialog.notice"),message:"此訂單非此分店下的訂單，將為你轉為正確分店",ok:{label:r.$t("dialog.ok"),color:"primary",textColor:"white"},persistent:!0}).onOk((function(){r.$router.replace({path:"/menu/"+i+"/"+e})}));else if(r.productOrder.order_info.menu_id!==r.menu_info.menu_id)r.handleDownwardCompatibility({from:"Menu",ver:167653938,params:{gbList:r.productOrder.order_others.group_buy_follower_order_list,invProSim:r.productOrder.order_others.order_info.invalid_product_simple,name:r.$route.name}});else if(3===o){var s=t.data.group_buy_head_order_info;20===s.head_buying_status&&(r.$route.meta.group_buying?r.$router.replace("/gb/close/"+r.$route.params.store_id+"/"+shareCode):r.$router.replace({path:"/gbClose/"+r.$route.params.store_id+"/"+shareCode})),r.$store.commit("order/setGbBrief",s)}}})).catch((function(){r.$q.dialog({class:"nidin-dialog",title:r.$t("dialog.notice"),message:"此訂單不存在，將幫您開立新訂單",ok:{label:r.$t("dialog.confirm"),color:"primary",textColor:"white"},persistent:!0}).onOk((function(){r.clearOrder((function(){r.$router.replace({path:"/menu/"+r.$route.params.store_id})}))}))}));case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getShareByOrderId:function(){var t=this,e="/carts/"+this.productOrder.order_id+"/share";this.getDataH(e,null).then((function(e){200===e.data.status&&t.setGBLink(e.data.share_code,!0)})).catch((function(t){}))},checkOffDay:function(){var t=this.$route.meta.group_buying||3===this.order_info.order_type;this.store_info.is_off_day&&!this.$route.params.order_id&&(this.store_info.order_tolerance_day&&this.store_info.is_off_allow_order&&!t?this.dialog("今日公休，只提供預訂單!<br>門市將於 "+this.store_info.next_opening_date+" 進行回覆！"):t||this.dialog("今日公休！<br>"+this.store_info.next_opening_date+" 才可訂購！"))},checkGBRouter:function(){var t=this,e=this.$route.params.store_id,o=this.$route.params.order_id,r=this.$route.params.share_code;if(r){var i="/groupBuy/"+r+"/info";this.getDataH(i,null).then((function(i){if(200===i.data.status){var s=i.data.group_buy_info.group_buy_list[0];s?(t.gb_info=s,o=t.gb_info.order_id):(t.setGATag("view.group_menu"),t.setGATag("join_group")),i.data.sent_sub_count>0&&20!==t.$store.state.order.gb_brief.group_buying_status&&t.$q.notify({message:"曾經跟過團"+i.data.sent_sub_count+"次囉！",color:"accent",timeout:2500,position:"bottom"}),1===i.data.group_buy_info.role?o?t.$router.replace({path:"/menu/"+e+"/"+o}):t.$router.replace({path:"/menu/"+e}):20===t.$store.state.order.gb_brief.group_buying_status?t.$route.meta.group_buying?t.$router.replace("/gb/close/"+e+"/"+r):t.$router.replace({path:"/gbClose/"+e+"/"+r}):s&&-1===t.$route.name.indexOf("Order")?(t.$route.meta.group_buying?t.$router.replace({path:"/gb/menu/"+e+"/"+s.order_id+"/"+r}):t.$router.replace({path:"/gbmenu/"+e+"/"+s.order_id+"/"+r}),t.getOrderInfo()):Object.keys(t.$store.state.order.gb_brief).length||t.getGbBriref()}})).catch((function(e){t.$router.push("/")}))}else t.setGATag("view.menu")},getGbBriref:function(){var t=c()(n.a.mark((function t(){var e,o,r;return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this,o=this.$route.params.share_code,r="/groupBuy/"+o+"/brief",t.next=5,this.getData(r,null).then((function(t){200===t.data.status&&e.$store.commit("order/setGbBrief",t.data.group_buy_brief)})).catch((function(t){}));case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),opentab:function(t){this.show.banner=!1;var e=t.url?t.url.trim():"",o="";0!==t.href_open_type&&2===t.url_get_type&&(o="/"!==e.substr(0,1)?"/".concat(e):"".concat(e)),0===t.href_open_type?this.show.banner=!0:1===t.href_open_type?e?1===t.url_get_type?window.open(e):2===t.url_get_type&&window.open("".concat(window.location.origin).concat(o)):this.show.banner=!0:2===t.href_open_type&&e?1===t.url_get_type?window.open(e,"_self"):2===t.url_get_type&&self.$router.push(o):this.show.banner=!0},updateStoreLocation:function(){var t=this,e="/store/".concat(this.store,"/info"),o={};this.curLocation.city_code&&(o.city_code=this.curLocation.city_code),this.latitude&&this.longitude&&(o.latitude=this.latitude,o.longitude=this.longitude),this.getData(e,null).then((function(e){200===e.data.status&&e.data.id&&(t.store_info.banner_c_info=e.data.banner_c_info,t.store_info.banner_info=e.data.banner_info,t.store_info.banners_advertisement=e.data.banners_advertisement,t.store_info.distance=e.data.distance)})).catch((function(t){}))},createFavoriteStore:function(){var t=this,e="/user/".concat(this.getUId,"/favorite/store/").concat(this.store_info.id);this.putDataH(e,null).then((function(e){200===e.status&&(t.$q.notify({icon:"check_circle",message:"加入最愛店家",color:"positive",timeout:2500,position:"bottom"}),t.isFavorite=!0)})).catch((function(t){}))},updateFavoriteStore:function(){this.isFavorite?this.deleteFavoriteStore():this.createFavoriteStore()},deleteFavoriteStore:function(){var t=this,e="/user/".concat(this.getUId,"/favorite/store/").concat(this.store_info.id);this.delDataH(e,null).then((function(e){200===e.status&&(t.$q.notify({icon:"check_circle",message:"移除最愛店家",color:"positive",timeout:2500,position:"bottom"}),t.isFavorite=!1)})).catch((function(t){}))},scrollTop:function(){var t=getScrollTarget(this.$refs.categoryPage);setScrollPosition(t,0,1)},searchList:function(t){var e=_.cloneDeep(this.faqList);t?(this.searchFaqOpt.icon="close",this.currentList=e.filter((function(e){var o=e.question_list.findIndex((function(e){return e.title.indexOf(t)>-1}));if(o>-1)return e.question_list=e.question_list.filter((function(e){return e.title.indexOf(t)>-1})),e})),this.currentCategory=-1):(this.searchFaqOpt.icon="search",this.currentList=e,this.currentCategory=0)},goCart:function(){var t="";t="voucher"===this.menuType?"/orderList/voucher/"+this.voucherOrder.order_id:this.$route.meta.group_buying?"/gb/orderList/"+this.productOrder.order_id:"/orderList/"+this.productOrder.order_id,this.$router.push(t)},checkVoucherMenuVersion:function(){var t=this,e="/store/"+this.store+"/voucherProductMenuVer";this.getData(e,null).then((function(e){var o=30601;if(200===e.data.status){t.voucher_menu_version=e.data;var r=e.data.version.stamp.toString(),i=t.$q.localStorage.getItem("Nidin_"+t.store+"_voucher_menu_version");t.voucherOrder.no_menu=!1,r!==i?t.getVoucherMenuJson(r):t.$q.platform.is.iphone&&t.$q.platform.is.safari?t.getVoucherMenuJson():t.$q.localStorage.getItem("Nidin_"+t.store+"_voucher_menu")?t.setVoucherMenu():t.getVoucherMenuJson()}else e.data.status===o&&(t.voucherOrder.no_menu=!0)})).catch((function(e){t.voucherOrder.no_menu=!0}))},getVoucherMenuJson:function(){var t=c()(n.a.mark((function t(){var e,o,r,i=this,s=arguments;return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=s.length>0&&void 0!==s[0]?s[0]:0,o="/store/"+this.store+"/voucherProductMenu",this.$q.platform.is.iphone&&this.$q.platform.is.safari)for(r in this.$q.localStorage.getAll())r.includes("Nidin")&&r.includes("voucher_menu")&&this.$q.localStorage.remove(r);this.getData(o,null).then((function(t){if(200===t.data.status){var o=[].concat(u()(t.data.special_list||[]),u()(t.data.list||[]));i.$q.localStorage.set("Nidin_"+i.store+"_voucher_menu_version",e),i.$q.localStorage.set("Nidin_"+i.store+"_voucher_menu",JSON.stringify(o)),i.setVoucherMenu()}})).catch((function(t){for(var e in i.$q.localStorage.getAll())i.$q.localStorage.remove(e);i.reload()}));case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),setVoucherMenu:function(){var t=this.$q.localStorage.getItem("Nidin_"+this.store+"_voucher_menu");this.voucherMenu=JSON.parse(t)},getVoucherCart:function(){var t=this,e="/voucherOrder/cartList",o={store_id:this.store,page:1,count:10};this.postData(e,o).then((function(e){200===e.data.status&&e.data.carts.length&&(t.voucherOrder.order_id=e.data.carts[0].order_id,t.voucherOrder.order_sn=e.data.carts[0].order_sn,t.voucherOrder.order_info=e.data.carts[0],t.getVoucherOrderInfo())})).catch((function(){t.$q.dialog({class:"nidin-dialog",title:t.$t("dialog.notice"),message:"此訂單不存在，將幫您開立新訂單",ok:{label:t.$t("dialog.confirm"),color:"primary",textColor:"white"},persistent:!0}).onOk((function(){t.clearOrder((function(){t.$router.replace({path:"/menu/"+t.$route.params.store_id})}))}))}))},getVoucherOrderInfo:function(){var t=this,e=this.voucherOrder.order_id,o="/voucherOrder/"+e+"/info";this.getData(o,null).then((function(e){200===e.data.status&&(t.$store.commit("cart/clearVouchers"),e.data.order_info.product.forEach((function(e){t.$store.commit("cart/addVoucher",{id:e.product_id,num:e.amount,categoryId:t.findVoucherCategoryId(e.product_id)})})))})).catch((function(t){}))},findVoucherCategoryId:function(t){var e=0;return this.voucherMenu.map((function(o){var r=o.product_map.some((function(e){return e.id===t}));r&&(e=o.id)})),e},checkVoucher:function(){this.voucherOpen?(this.checkVoucherMenuVersion(),this.isLogin&&!this.isPhoneVerity&&this.getVoucherCart(),this.isVoucher&&(this.menuType="voucher")):this.isVoucher&&!this.voucherOpen&&this.$router.replace({path:"/menu/"+this.$route.params.store_id})},setDefaultDeliveryType:function(){if(this.store_info.delivery_info&&Object.keys(this.store_info.delivery_info).length&&!this.productOrder.order_info){var t=this.store_info.delivery_info,e=t.find((function(t){return 1===t.is_default}));e&&(this.defaultDeliveryType=e.delivery_type)}}},mounted:function(){var t=c()(n.a.mark((function t(){var e;return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.handlerTheme({step:1,type:3,menu:Number(this.$route.params.store_id)}),t.next=3,this.getStoreInfo();case 3:return t.next=5,this.getBrandInfo();case 5:return this.setDefaultDeliveryType(),4===this.storeMode&&this.$router.replace({name:"VendorStore",params:{store_id:this.store}}),t.next=9,this.checkMenuVersion();case 9:if(this.getDisableProd(),e=this.$route.params.share_code,e&&(this.share_code=e),!this.isLogin){t.next=16;break}return t.next=15,this.checkGBRouter();case 15:this.$route.params.order_id&&!this.isVoucher&&(this.productOrder.order_id=this.$route.params.order_id,this.getOrderInfo());case 16:this.checkVoucher(),this.getFaqList(),this.changePanelHeight(),this.checkOffDay(),this.getStoreActivityList(),this.isPhoneVerity||this.getMappingList(),this.getProductIcons(),this.getProductImgs(),this.getProductSettion();case 25:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),beforeRouteEnter:function(t,e,o){o((function(t){t.$store.commit("order/setGbBrief",{}),t.$store.commit("cart/clearProducts"),t.$store.commit("cart/clearVouchers"),o()}))},watch:{"productOrder.order_info.order_id":function(t){this.productOrder.order_id=t},"voucherOrder.order_info.order_id":function(t){this.voucherOrder.order_id=t},"$route.params.store_id":function(){var t=c()(n.a.mark((function t(){return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.store=this.$route.params.store_id,this.show.loading=!0,4===this.storeMode&&this.$router.replace({name:"VendorStore",params:{store_id:this.store}}),t.next=5,this.getStoreInfo();case 5:return t.next=7,this.checkMenuVersion();case 7:this.checkVoucher(),this.getDisableProd(),this.getStoreActivityList(),this.getProductImgs();case 11:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),"show.modal_gb":function(){this.show.modal_gb&&!this.$store.state.app.liff.ready&&(this.copyLink(),this.setGATag("group",null,{link:this.gb_link}),this.setGATag("view.group_window",null,{link:this.gb_link}))},"curLocation.city_code":function(t){var e=this;t&&setTimeout((function(){e.updateStoreLocation()}),100)},tab:function(){this.changePanelHeight()},searchFaq:function(t){var e=this;this.$nextTick((function(){e.$refs.orderInfoCategory&&(e.categoryHeight=e.$refs.orderInfoCategory.offsetHeight)})),this.searchList(t)}}},At=jt,Mt=(o("25d4"),Object(I["a"])(At,r,i,!1,null,"283a1dec",null));e["default"]=Mt.exports},"25d4":function(t,e,o){"use strict";var r=o("5a63"),i=o.n(r);i.a},4862:function(t,e,o){"use strict";var r=o("b5cc"),i=o.n(r);i.a},"5a63":function(t,e,o){},"738e":function(t,e,o){"use strict";var r=o("ec64"),i=o.n(r);i.a},b5cc:function(t,e,o){},ec64:function(t,e,o){},f185:function(t,e,o){}}]);